<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Most Common Jumping Spiders</title>
    <link rel="stylesheet" href="../styles/index.css" />
    <link rel="icon" href="../media/eyes.png" type="image/x-icon" />
  </head>
  <body>
    <header>
      <h1>Jumping Spiders of Ontario</h1>
      <h3>Salticidae you can find in Ontario, Canada.</h3>
      <nav class="menu">
        <button id="menu-toggle">â˜°</button>
        <ul id="menu-links">
          <li>
            <a href="pages/index.html"
              ><img
                src="./media/eyes.png"
                alt="Jumping Spider eyes"
                class="menu-logo"
              />Home</a
            >
          </li>
          <li>
            <a href="pages/species.html"
              ><img
                src="./media/spider.png"
                alt="spider"
                class="menu-logo"
              />Species</a
            >
          </li>
          <li>
            <a href="pages/ecosystem.html"
              ><img
                src="./media/earth.png"
                alt="earth"
                class="menu-logo"
              />Ecosystem</a
            >
          </li>
          <li>
            <a href="https://inaturalist.ca" target="_blank"
              ><img
                src="./media/inaturalist.png"
                alt="iNaturalist"
                class="menu-logo"
              />iNaturalist</a
            >
          </li>
          <li>
            <a href="pages/guide.html"
              ><img
                src="./media/compass.png"
                alt="compass"
                class="menu-logo"
              />Identification</a
            >
          </li>
          <li>
            <a href="pages/evolution.html"
              ><img
                src="./media/tree.png"
                alt="tree"
                class="menu-logo"
              />Evolution</a
            >
          </li>
        </ul>
      </nav>
    </header>

    <div id="spiders"></div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Spider Data and Image Rendering
        fetch("/Jumping_spiders/data/jumping_spider_list.json")
          .then((response) => response.json())
          .then((data) => {
            data.sort((a, b) => (b.sightings ?? 0) - (a.sightings ?? 0));

            const container = document.getElementById("spiders");

            data.forEach((spider) => {
              const scientificName =
                spider.scientific_name.charAt(0).toLowerCase() +
                spider.scientific_name.slice(1);
              const regularName =
                spider.regular_name && spider.regular_name.trim() !== ""
                  ? spider.regular_name
                  : "No common name";
              const sightings = spider.sightings ?? 0;

              const card = document.createElement("div");
              card.className = "spider-card";

              const header = document.createElement("h2");
              header.textContent = `${spider.scientific_name} - ${regularName} (${sightings} sightings)`;
              card.appendChild(header);

              const imageGrid = document.createElement("div");
              imageGrid.className = "image-grid";

              for (let i = 1; i <= 4; i++) {
                const img = document.createElement("img");
                img.src = `/Jumping_spiders/media/${scientificName.replace(
                  / /g,
                  "_"
                )}_${i}.jpg`;
                console.log(img.src); // Log the image source for debugging
                img.alt = regularName;
                img.loading = "lazy"; // Add lazy loading
                img.onerror = () => {
                  img.style.display = "none"; // Hide broken images
                };
                imageGrid.appendChild(img);
              }

              card.appendChild(imageGrid);
              container.appendChild(card);
            });
          })
          .catch((err) => {
            console.error("Failed to load spider data:", err);
            const container = document.getElementById("spiders");
            container.innerHTML =
              "<p>Error loading spider data. Please try again later.</p>";
          });
      });
    </script>
    <script src="/Jumping_spiders/scripts/index.js" defer></script>
  </body>
</html>
